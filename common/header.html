<script type="text/discourse-plugin" version="0.0.1">

function extractImages(html){
  const imgs = html.querySelectorAll("img");
  var length = [...imgs].length;
  if (length > 0){
    return [imgs[0].outerHTML, imgs[1].outerHTML];
  } else {
    return ["No image found", "No image found"]
  }
}


  function componentPrep(cooked)
  {
    console.log("decorate cooked")
    cooked.querySelectorAll('div[data-image-comparison-slider]').forEach(slider => {
      slider.style.backgroundColor = "##1B1F26";
      slider.style.color = "#1B1F26";
      let imgs = extractImages(slider.innerHTML);
      let finalHTML = imgs.join(" ");
      console.log(slider);
    })
  }


    let translations = I18n.translations[I18n.currentLocale()].js;

    if (!translations) {
      translations = {};
    }
    if (!translations.composer) {
      translations.composer = {};
    }
    translations.button_text = settings.button_text;
    translations.composer.add_images_prompt =
      settings.add_images_prompt;


    api.decorateCookedElement(componentPrep, {
        onlyStream: false, 
        id: 'image-comparison-slider'
      });


    api.onToolbarCreate(function(toolbar){
        toolbar.addButton({
            trimLeading: true,
            id: "image-comparison-slider",
            group: "insertions",
            icon: "bolt",
            title: "image-comparison-slider",
            perform: e => e.applySurround(
                "<div data-image-comparison-slider>\n\n",
                "\n\n</div>",
                "add_images_prompt",
                { multiline: false }
            )
        });
    });
</script>